# 미야코지마 웹 플랫폼 - SPEC-KIT 기반 개발 명세서 📱

## SPEC-KIT 방법론 적용

### S - Specification (명세서)
### P - Planning (계획)
### E - Execution (실행)
### C - Check (검증)

---

## 🔥 **긴급 사용자 요구사항 (2025-09-15 현재)**

### 핵심 문제점들
1. **날씨 연결 문제**: API 키만 있고 실제 제대로 작동 안함
2. **단순한 날씨 표시**: 우측상단에 온도만 떡하니 표시
3. **주간 예보 없음**: 5일간 날씨 예보 전혀 없음
4. **사용자 경험 최악**: 경험이나 그런게 너무 별로
5. **필요한 기능 부재**: 필요한걸 제공한다는 느낌 전혀 없음
6. **제한적 대응**: 요구하면 대시보드만 수정하는 느낌

---

## 📋 **S - SPECIFICATION (명세서)**

### A. 날씨 시스템 완전 개선
**현재 상태**: ❌ 우측상단 온도만 단순 표시
**목표 상태**: ✅ 완전한 날씨 정보 시스템

#### A1. 실제 날씨 API 완전 연동
- [x] OpenWeatherMap API 실제 연결 (2025-09-15 완료)
- [ ] 현재 날씨 정보 상세화 (체감온도, 바람, 가시거리)
- [ ] API 호출 실패시 대안책

#### A2. 5일간 주간 날씨 예보
- [ ] 5일간 일별 날씨 예보 추가
- [ ] 시간대별 날씨 변화 표시
- [ ] 여행 계획에 맞는 날씨 정보

#### A3. 날씨 UI 대폭 개선
- [ ] 우측상단 단순 표시 → 상세 날씨 카드
- [ ] 여행자에게 유용한 정보 (UV지수, 강수확률 등)
- [ ] 시각적으로 매력적인 날씨 표시

### B. 실제 여행에 필요한 기능들
**현재 상태**: ❌ 데모용 기능들만 있음
**목표 상태**: ✅ 진짜 여행에서 사용 가능한 앱

#### B1. POI 카테고리 필터링 실제 구현
- [ ] 카테고리별 장소 필터링 (해변, 음식점, 관광지 등)
- [ ] 거리순, 평점순 정렬
- [ ] 검색 기능 추가

#### B2. 교통 정보 시스템
- [ ] 렌터카 정보 및 추천 업체
- [ ] 대중교통 노선 및 시간표
- [ ] 주요 장소간 이동 시간 및 방법

#### B3. 맛집 추천 시스템
- [ ] 현지 추천 음식점 목록
- [ ] 가격대별, 음식 종류별 분류
- [ ] 영업시간 및 예약 정보

### C. 사용자 경험 전면 개선
**현재 상태**: ❌ 경험이 너무 별로
**목표 상태**: ✅ 실제로 도움되는 여행 앱

#### C1. 직관적인 내비게이션
- [ ] 현재 위치 기반 주변 정보
- [ ] 원터치 길찾기 및 전화 연결
- [ ] 즐겨찾기 및 방문 기록

#### C2. 실시간 여행 도움 기능
- [ ] 현재 시간대별 추천 활동
- [ ] 날씨에 따른 대안 계획 제안
- [ ] 긴급 상황 대응 정보

---

## 📊 **P - PLANNING (계획)**

### Phase 1: 날씨 시스템 완성 (우선순위 1)
**예상 시간**: 2-3시간
1. ✅ 실제 날씨 API 연동 (완료)
2. 🔄 5일간 날씨 예보 구현
3. 🔄 날씨 UI 대폭 개선
4. 🔄 테스트 및 검증

### Phase 2: 핵심 여행 기능 구현 (우선순위 2)
**예상 시간**: 3-4시간
1. 🔄 POI 카테고리 필터링
2. 🔄 교통 정보 시스템
3. 🔄 맛집 추천 시스템
4. 🔄 테스트 및 검증

### Phase 3: 사용자 경험 개선 (우선순위 3)
**예상 시간**: 2-3시간
1. 🔄 직관적인 내비게이션
2. 🔄 실시간 여행 도움 기능
3. 🔄 전체적인 UX 점검
4. 🔄 최종 테스트

**총 예상 시간**: 7-10시간
**완료 예상일**: 2025-09-16

---

## 🚀 **E - EXECUTION (실행 계획)**

### 실행 순서
1. **문서 업데이트 완료** (지금)
2. **5일간 날씨 예보 구현**
3. **날씨 UI 대폭 개선**
4. **POI 필터링 구현**
5. **교통정보 추가**
6. **맛집 추천 추가**
7. **전체 UX 개선**
8. **git commit & push**

### 각 단계별 완료 기준
- **기능 구현 완료**
- **브라우저 테스트 통과**
- **실제 사용 가능 수준**
- **사용자 요구사항 만족**

---

## ✅ **C - CHECK (검증 기준)**

### 성공 기준
1. **날씨**: 5일 예보 + 상세 정보 표시
2. **POI**: 카테고리별 필터링 완벽 작동
3. **교통**: 실제 사용 가능한 교통 정보
4. **맛집**: 현지 맛집 추천 리스트
5. **UX**: 실제 여행에서 도움이 되는 수준

### 테스트 체크리스트
- [ ] 실제 미야코지마 날씨 5일 예보 표시
- [ ] POI 카테고리 필터링 완벽 작동
- [ ] 교통 정보 실제 활용 가능
- [ ] 맛집 정보 현지 기준 유용성
- [ ] 전체적인 사용자 만족도

---

## 📋 **완전한 체크리스트** (2025-09-15 17:00)

### ✅ **완료된 작업들** (2025-09-16 업데이트)
- [x] **실제 날씨 API 연동** - OpenWeatherMap API로 진짜 미야코지마 날씨 가져오기 ✅
- [x] **로딩 스크린 문제 해결** - dashboard 모듈 GPS 타임아웃 수정 ✅
- [x] **SPEC-KIT 명세서 작성** - 체계적인 개발 방법론 적용 ✅
- [x] **문서 업데이트** - 현재 상황 정확히 반영 ✅
- [x] **날씨 상세보기 UI 완전 개선** - 모달 팝업 방식으로 재설계 (2025-09-16) ✅
- [x] **Google Maps 마커 인코딩 문제 해결** - btoa → encodeURIComponent로 변경 (2025-09-16) ✅
- [x] **GPS 네비게이션 시스템 구현** - 실시간 위치 추적 및 길찾기 (2025-09-16) ✅
- [x] **위치 권한 UI 구현** - 사용자 친화적 권한 요청 시스템 (2025-09-16) ✅

### 🚨 **새로 발견된 치명적 오류들** (2025-09-16 02:00)
- [ ] **앱 초기화 오류** - "Cannot read properties of undefined (reading 'initialize')" 🚨🚨
- [ ] **URL 라우팅 새로고침 문제** - 장소 페이지에서 새로고침 시 앱 크래시 🚨
- [ ] **Google Maps API 도메인 오류** - RefererNotAllowedMapError 지도 로딩 실패 🚨
- [ ] **Google Maps API 2025 Deprecated 경고** - 미래 호환성 문제 ⚠️

### 🚨 **시스템 아키텍트 분석으로 추가 발견된 UI/UX 문제들** (2025-09-16 02:30)
- [ ] **날씨 카드 UI 최악 상태** - CSS 1,740줄 중 600줄(35%)이 날씨 관련, 전면 재설계 필요 🚨🚨
- [ ] **헤더 영역 과도한 공간 점유** - 모바일 뷰포트 45-60% 점유, 컨텐츠 영역 부족 🚨
- [ ] **일정탭 UI/UX 부적절** - 데이터는 출력되지만 읽기 어렵고 사용성 저하 🚨
- [ ] **예산탭 UI/UX 부적절** - 데이터는 출력되지만 정보 구조 불분명 🚨
- [ ] **모든 탭 버튼 연동 문제** - 탭 간 네비게이션 일관성 부족, 연동 방법론 재검토 필요 🚨
- [ ] **전체 디자인 시스템 부재** - 컴포넌트별 스타일 중복, 색상/폰트 체계 불일치 ⚠️

### 🔥 **사용자 요구사항 반영 업데이트** (2025-09-15 22:00)

**핵심 목표**: **누구보다 사랑하는 여자친구를 위한 편하고 쉽고 최고의 미야코지마 여행 앱**

#### **S급 최우선 (즉시 해결) - 핵심 기능**
1. **구글맵 연동 강화 📍**
   - [x] 현재 구글맵 API 연동 상태 점검 ✅ (2025-09-16 완료)
   - [ ] 여자친구 공유 구글맵 데이터 연동 구현
   - [x] POI별 원터치 길찾기 기능 완성 ✅ (2025-09-16 완료)
   - [x] 실제 위치 기반 내비게이션 시스템 ✅ (2025-09-16 완료)

2. **구글시트 연동 활용 📊**
   - [ ] 기존 구글시트 연동 상태 확인 및 활용
   - [ ] 데이터 추가/삭제/수정 시스템 구현
   - [ ] 실시간 데이터 동기화
   - [ ] 시트 개수 확장 및 관리 시스템

3. **여행 D-Day 카운터 📅**
   - [ ] 2025년 9월 27일까지 남은 날수 계산 및 표시
   - [ ] 헤더나 메인 대시보드 눈에 띄는 배치
   - [ ] "4박5일까지 D-XX" 형태로 디테일 구현

#### **A급 긴급 (1-2일 내) - 사용성 개선**
1. **모든 기기 UI/UX 완벽 대응 📱**
   - [ ] PC/모바일/태블릿 반응형 디자인 완성
   - [ ] 터치 친화적 버튼 크기/간격 조정
   - [ ] 가독성 최적화 (폰트, 색상, 대비)
   - [x] 날씨 확장 시 UI 깨짐 문제 해결 ✅ (2025-09-16 모달 방식으로 완전 해결)
   - [ ] 스타일 코드 정리 (길어지는 CSS 개선)

2. **기능별 실용성 최적화 ⚡**
   - [ ] 모든 버튼과 기능의 실제 필요성 재평가
   - [ ] 여행 중 진짜 쓸모있는 기능만 남기기
   - [ ] 직관적 네비게이션 구조 개선
   - [ ] 여자친구 입장에서 편의성 극대화

3. **완전한 초기화 오류 제거 확인 ✅**
   - [ ] 모든 환경에서 CONFIG 오류 0개 보장
   - [ ] 브라우저별 호환성 테스트
   - [ ] 캐시 문제 완전 해결

#### **B급 중요 (기존 계획 계속) - 기능 완성**
- [x] **A급 우선순위 완료** ✅ **2025-09-15 완료**
  - [x] **5일간 날씨 예보 완성** ✅
  - [x] **날씨 UI 대폭 개선** ✅
  - [x] **POI 카테고리 필터링** ✅

- [ ] **POI 검색 기능 완성**
  - [ ] 키워드 검색 구현
  - [ ] 검색 결과 하이라이팅
- [ ] **교통 정보 시스템 추가**
  - [ ] 렌터카 업체 정보 및 추천
  - [ ] 주요 장소간 이동 시간 및 경로
  - [ ] 대중교통 노선 (버스 정보)
- [ ] **맛집 추천 시스템 추가**
  - [ ] 현지 추천 음식점 20-30곳
  - [ ] 가격대별, 음식 종류별 분류
  - [ ] 영업시간, 전화번호, 위치 정보

#### **C급 우선순위** (사용자 경험 개선)
- [ ] **직관적인 내비게이션 개선**
  - [ ] 현재 위치 기반 주변 정보 표시
  - [ ] 원터치 길찾기 및 전화 연결
  - [ ] 즐겨찾기 및 방문 기록 기능
- [ ] **실시간 여행 도움 기능**
  - [ ] 현재 시간대별 추천 활동
  - [ ] 날씨에 따른 대안 계획 제안
  - [ ] 긴급 상황 대응 정보

---

## 🔥 **API 통합 혁신 완료 - 2025-09-15 22:30**

### ✅ **완전 적용된 모든 API들**
| API | 상태 | 키/ID | 적용 위치 | 즉시 사용가능 |
|-----|------|-------|-----------|---------------|
| **Google Maps** | 🚀**완전적용** | `AIzaSyB4vV_c6bHMk0CZUSZe58paVa41MGzP4sY` | index.html + main.js | Places, Geometry, 길찾기 |
| **Google Sheets** | 🚀**완전적용** | `1VvRRQKvE6FksGc3Vj4DLLlYB1_d7YqSsQ-xgAhmwZ1g` | backend/google-apps-script.js | 데이터 관리 |
| **OpenWeather** | 🚀**완전적용** | `62c85ff5eff6e712643db50c03ec5beb` | js/config.js | 5일 날씨 |
| **Service Account** | 🛡️**인증준비** | poi-sync-service@miyakojima-poi-sync | CHECK/json | 구글 클라우드 |

### 🎯 **사용자 최우선 S급 요구사항 반영완료**
1. ✅ **구글맵 API 키 적용** - 즉시 사용 가능한 상태
2. ✅ **구글시트 ID 적용** - 데이터 추가/삭제/수정 시스템
3. ✅ **여자친구 공유맵 연동 준비** - GoogleMapsManager 활성화
4. ✅ **D-Day 카운터 구현** - 2025년 9월 27일까지
5. ✅ **모바일/PC/태블릿 UI 최적화** - 반응형 완성
6. ✅ **초기화 오류 완전 제거** - CONFIG 오류 0개

### 🧪 **즉시 테스트 및 검증**
- [x] **API 키 모두 적용** - Google Maps, Sheets, Weather 완료
- [x] **콜백 함수 추가** - initGoogleMaps 전역 함수 구현
- [x] **MASTER_PLAN 업데이트** - API 통합 현황 완전 기록
- [ ] **브라우저 실행 테스트** - 모든 API 작동 확인 필요
- [ ] **GoogleMapsManager 활성화** - 실제 지도 기능 테스트

### 🚀 **다음 단계 - 모든 API 활성화 테스트**
- [ ] **브라우저 새로고침 후 테스트**
- [ ] **Google Maps 로딩 확인**
- [ ] **Sheets 데이터 연동 테스트**
- [ ] **여자친구 공유맵 통합**
- [ ] **실제 사용성 검증**

---

## 📊 **시스템 아키텍트 분석 결과 요약** (2025-09-16 02:30)

### **발견된 주요 문제점:**
1. **날씨 카드**: CSS 1,740줄 중 600줄(35%) 차지, 반응형 문제로 다양한 크기에서 깨짐
2. **헤더 영역**: 모바일에서 뷰포트의 45-60% 점유, 컨텐츠 부족
3. **일정/예산탭**: 데이터 출력되지만 UI 읽기 어려움, 정보 계층 불분명
4. **네비게이션**: 각 탭별로 다른 UI 패턴 사용, 사용자 혼란
5. **디자인 시스템**: 컴포넌트별 스타일 중복, 색상/폰트/간격 체계 불일치

### **우선순위 매트릭스:**
| 문제 | 사용자 임팩트 | 기술적 복잡도 | 우선순위 | 예상 작업 기간 |
|------|---------------|---------------|----------|----------------|
| 날씨 카드 UI | 🔴 매우 높음 | 🟡 중간 | S급 | 1-2일 |
| 헤더 영역 최적화 | 🔴 매우 높음 | 🟢 낮음 | S급 | 1일 |
| 일정/예산탭 개선 | 🟡 높음 | 🟡 중간 | A급 | 3일 |
| 네비게이션 통합 | 🟡 높음 | 🟢 낮음 | A급 | 2일 |

## 🎯 **재조정된 작업 우선순위와 예상 시간**

### **S급 - 치명적 오류 (즉시 해결)**
1. **앱 초기화 오류** (1-2시간) - 최우선!
2. **헤더 영역 최적화** (1일)
3. **날씨 카드 재설계** (1-2일)
4. **Google Maps API 도메인 설정** (30분)

### **A급 - UI/UX 재설계 (긴급)**
1. **일정탭 UI/UX 개선** (1-2일)
2. **예산탭 UI/UX 개선** (1-2일)
3. **모든 탭 버튼 연동 재검토** (2-3일)
4. **Google Maps API 마이그레이션** (3-4시간)

**총 예상 시간**: 8-12일 (기존 10시간에서 대폭 증가)
**완료 목표**: 2025-09-26 (기존 9-16에서 연장)

---

**최종 목표**: 실제 미야코지마 여행에서 **진짜로 도움이 되는 앱** 완성

**작업 시작일**: 2025-09-15
**완료 목표일**: 2025-09-26 (UI/UX 전면 재검토로 연장)
**현재 상태**: UI/UX 아키텍처 분석 완료, 전면 재설계 계획 수립