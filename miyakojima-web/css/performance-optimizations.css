/**
 * âš¡ Core Web Vitals ìµœì í™” & ì„±ëŠ¥ í–¥ìƒ ìŠ¤íƒ€ì¼
 * LCP < 2.5s | FID < 100ms | CLS < 0.1
 */

/* =============================================================================
   ğŸš€ LCP (Largest Contentful Paint) ìµœì í™”
   ============================================================================= */

/* ì¤‘ìš” ì½˜í…ì¸  ìš°ì„  ë¡œë”© */
.main-header,
.weather-card,
.dashboard-card:first-child {
  contain: layout style paint;
  will-change: auto; /* ì´ˆê¸° ë¡œë”© í›„ GPU ì‚¬ìš© í•´ì œ */
}

/* ì´ë¯¸ì§€ ë¡œë”© ìµœì í™” */
img {
  loading: lazy; /* ì§€ì—° ë¡œë”© */
  decoding: async; /* ë¹„ë™ê¸° ë””ì½”ë”© */
}

/* í¬ë¦¬í‹°ì»¬ ì´ë¯¸ì§€ëŠ” ì¦‰ì‹œ ë¡œë”© */
.header img,
.weather-icon-large {
  loading: eager;
}

/* í°íŠ¸ ë¡œë”© ìµœì í™” */
@font-face {
  font-family: 'Noto Sans KR';
  font-style: normal;
  font-weight: 400;
  font-display: swap; /* FOIT ë°©ì§€ */
  src: local('Noto Sans KR Regular'),
       url('/fonts/NotoSansKR-Regular.woff2') format('woff2');
}

/* =============================================================================
   âš¡ FID (First Input Delay) ìµœì í™”
   ============================================================================= */

/* ë²„íŠ¼ ì‘ë‹µì„± ê°œì„  */
.btn {
  cursor: pointer;
  touch-action: manipulation; /* ë”ë¸”íƒ­ ì§€ì—° ì œê±° */
  -webkit-tap-highlight-color: transparent; /* iOS íƒ­ í•˜ì´ë¼ì´íŠ¸ ì œê±° */
}

/* ìŠ¤í¬ë¡¤ ì„±ëŠ¥ ê°œì„  */
.main-container,
.poi-list,
.expense-list {
  -webkit-overflow-scrolling: touch; /* iOS ìŠ¤í¬ë¡¤ ë¶€ë“œëŸ½ê²Œ */
  overscroll-behavior: contain; /* ìŠ¤í¬ë¡¤ ì²´ì´ë‹ ë°©ì§€ */
}

/* ì…ë ¥ ì§€ì—° ìµœì†Œí™” */
.form-input,
.form-select,
.form-textarea {
  will-change: auto;
}

.form-input:focus,
.form-select:focus,
.form-textarea:focus {
  will-change: transform, box-shadow;
}

/* =============================================================================
   ğŸ“ CLS (Cumulative Layout Shift) ë°©ì§€
   ============================================================================= */

/* ë¡œë”© ìŠ¤ì¼ˆë ˆí†¤ í¬ê¸° ê³ ì • */
.loading-skeleton {
  background: linear-gradient(
    90deg,
    var(--color-gray-200) 25%,
    var(--color-gray-100) 50%,
    var(--color-gray-200) 75%
  );
  background-size: 200% 100%;
  animation: skeleton-loading 1.5s ease-in-out infinite;
}

@keyframes skeleton-loading {
  0% {
    background-position: -200% 0;
  }
  100% {
    background-position: 200% 0;
  }
}

/* ì¹´ë“œ ì»¨í…Œì´ë„ˆ í¬ê¸° ì˜ˆì•½ */
.dashboard-grid {
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: var(--spacing-md);
}

.card {
  min-height: 200px; /* ìµœì†Œ ë†’ì´ ì˜ˆì•½í•˜ì—¬ ë ˆì´ì•„ì›ƒ ì‹œí”„íŠ¸ ë°©ì§€ */
}

/* ì´ë¯¸ì§€ ë¹„ìœ¨ ìœ ì§€ */
.aspect-ratio {
  position: relative;
  width: 100%;
}

.aspect-ratio::before {
  content: '';
  display: block;
  padding-top: 56.25%; /* 16:9 ë¹„ìœ¨ */
}

.aspect-ratio > * {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
}

/* ë‚ ì”¨ ì•„ì´ì½˜ í¬ê¸° ê³ ì • */
.weather-icon-large {
  width: 48px;
  height: 48px;
  display: inline-block;
}

/* =============================================================================
   ğŸ–¼ï¸ ë¦¬ì†ŒìŠ¤ ìµœì í™”
   ============================================================================= */

/* CSS ì• ë‹ˆë©”ì´ì…˜ ìµœì í™” */
@keyframes optimized-fade-in {
  from {
    opacity: 0;
    transform: translate3d(0, 10px, 0); /* GPU ê°€ì† */
  }
  to {
    opacity: 1;
    transform: translate3d(0, 0, 0);
  }
}

.fade-in {
  animation: optimized-fade-in 0.3s ease-out;
}

/* ë¶ˆí•„ìš”í•œ repaint ë°©ì§€ */
.btn:hover,
.card:hover {
  transform: translate3d(0, -2px, 0); /* GPU ê°€ì† í™œìš© */
}

/* ìŠ¤í¬ë¡¤ ì„±ëŠ¥ ê°œì„  */
.scrollable {
  -webkit-transform: translateZ(0); /* GPU ë ˆì´ì–´ ìƒì„± */
  transform: translateZ(0);
  -webkit-perspective: 1000;
  perspective: 1000;
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
}

/* =============================================================================
   ğŸ“± ëª¨ë°”ì¼ ì„±ëŠ¥ ìµœì í™”
   ============================================================================= */

/* ëª¨ë°”ì¼ì—ì„œ GPU ì‚¬ìš© ìµœì†Œí™” */
@media (max-width: 768px) {
  .card:hover,
  .btn:hover {
    transform: none; /* í˜¸ë²„ íš¨ê³¼ ë¹„í™œì„±í™” */
  }

  /* ì• ë‹ˆë©”ì´ì…˜ ê°„ì†Œí™” */
  * {
    animation-duration: 0.2s !important;
    transition-duration: 0.2s !important;
  }

  /* ë³µì¡í•œ ê·¸ë¼ë°ì´ì…˜ ì œê±° */
  .btn-primary {
    background: var(--miyako-primary);
  }
}

/* =============================================================================
   ğŸ”„ ë©”ëª¨ë¦¬ ê´€ë¦¬
   ============================================================================= */

/* ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ìš”ì†Œì˜ GPU ë ˆì´ì–´ í•´ì œ */
.card:not(:hover),
.btn:not(:hover):not(:focus) {
  will-change: auto;
}

/* ì˜¤í”„ìŠ¤í¬ë¦° ì½˜í…ì¸  ìµœì í™” */
.section:not(.active) {
  content-visibility: hidden; /* ë¸Œë¼ìš°ì € ë Œë”ë§ ìŠ¤í‚µ */
}

.section.active {
  content-visibility: visible;
}

/* =============================================================================
   ğŸ¨ ë Œë”ë§ ìµœì í™”
   ============================================================================= */

/* ë³µí•© ë ˆì´ì–´ ìµœì í™” */
.modal,
.toast,
.loading-screen {
  isolation: isolate; /* ìƒˆë¡œìš´ ìŠ¤íƒ ì»¨í…ìŠ¤íŠ¸ ìƒì„± */
}

/* í˜ì¸íŠ¸ ìµœì í™” */
.dashboard-grid {
  contain: layout style paint size;
}

/* í…ìŠ¤íŠ¸ ë Œë”ë§ ìµœì í™” */
body {
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* =============================================================================
   ğŸŒ ë„¤íŠ¸ì›Œí¬ ìµœì í™”
   ============================================================================= */

/* ë¦¬ì†ŒìŠ¤ íŒíŠ¸ */
/*
HTML headì— ì¶”ê°€í•  ë‚´ìš©:
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://maps.googleapis.com">
<link rel="dns-prefetch" href="https://api.openweathermap.org">
*/

/* ì¤‘ìš” CSS ì¸ë¼ì¸í™”ë¥¼ ìœ„í•œ í¬ë¦¬í‹°ì»¬ ìŠ¤íƒ€ì¼ ë¶„ë¦¬ */
.critical-styles {
  /* ì´ í´ë˜ìŠ¤ì˜ ëª¨ë“  ìŠ¤íƒ€ì¼ì€ HTML headì— ì¸ë¼ì¸ìœ¼ë¡œ ì‚½ì… */
  display: none;
}

/* =============================================================================
   ğŸ“Š ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§
   ============================================================================= */

/* ì„±ëŠ¥ ë””ë²„ê¹…ìš© (ê°œë°œ í™˜ê²½ì—ì„œë§Œ ì‚¬ìš©) */
.perf-debug {
  outline: 1px solid rgba(255, 0, 0, 0.3);
}

.perf-debug:hover {
  outline-color: rgba(255, 0, 0, 0.8);
}

/* =============================================================================
   ğŸ”§ ë¸Œë¼ìš°ì €ë³„ ìµœì í™”
   ============================================================================= */

/* Chrome/Webkit ìµœì í™” */
@supports (-webkit-appearance: none) {
  .btn {
    -webkit-transform-style: preserve-3d;
    transform-style: preserve-3d;
  }
}

/* Firefox ìµœì í™” */
@-moz-document url-prefix() {
  .card {
    transform: translateZ(0);
  }
}

/* Safari ìµœì í™” */
@supports (-webkit-backdrop-filter: blur(10px)) {
  .weather-card {
    -webkit-backdrop-filter: blur(10px);
    backdrop-filter: blur(10px);
  }
}

/* =============================================================================
   âš¡ ì§€ì—° ë¡œë”© ìµœì í™”
   ============================================================================= */

/* Intersection Observer ì‚¬ìš©ì„ ìœ„í•œ ìŠ¤íƒ€ì¼ */
.lazy-load {
  opacity: 0;
  transform: translateY(20px);
  transition: opacity 0.3s ease, transform 0.3s ease;
}

.lazy-load.loaded {
  opacity: 1;
  transform: translateY(0);
}

/* ì´ë¯¸ì§€ ì§€ì—° ë¡œë”© placeholder */
.img-placeholder {
  background: var(--color-gray-200);
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--color-gray-600);
  font-size: var(--font-size-sm);
}

.img-placeholder::after {
  content: 'ğŸ–¼ï¸ ì´ë¯¸ì§€ ë¡œë”© ì¤‘...';
}

/* =============================================================================
   ğŸƒâ€â™‚ï¸ ì• ë‹ˆë©”ì´ì…˜ ìµœì í™”
   ============================================================================= */

/* 60fps ë³´ì¥ì„ ìœ„í•œ GPU ê°€ì† ì• ë‹ˆë©”ì´ì…˜ */
@keyframes gpu-optimized-slide {
  from {
    transform: translate3d(100%, 0, 0);
  }
  to {
    transform: translate3d(0, 0, 0);
  }
}

.slide-in {
  animation: gpu-optimized-slide 0.3s ease-out;
}

/* ë³µí•© ë ˆì´ì–´ ìƒì„± ìµœì í™” */
.animated-element {
  will-change: transform, opacity;
}

.animated-element.animation-complete {
  will-change: auto; /* ì• ë‹ˆë©”ì´ì…˜ ì™„ë£Œ í›„ GPU ì‚¬ìš© í•´ì œ */
}

/* =============================================================================
   ğŸ“ˆ ì„±ëŠ¥ ì¸¡ì • í—¬í¼
   ============================================================================= */

/* ê°œë°œìš© ì„±ëŠ¥ ì¸¡ì • ë§ˆì»¤ */
/*
JavaScriptì—ì„œ ì‚¬ìš©:
performance.mark('miyako-css-start');
// CSS ì ìš© í›„
performance.mark('miyako-css-end');
performance.measure('miyako-css', 'miyako-css-start', 'miyako-css-end');
*/

/* =============================================================================
   ğŸ¯ Core Web Vitals ì²´í¬ë¦¬ìŠ¤íŠ¸

   âœ… LCP ìµœì í™”
   - ì¤‘ìš” ì½˜í…ì¸  ìš°ì„  ë Œë”ë§
   - í°íŠ¸ ìµœì í™” (font-display: swap)
   - ì´ë¯¸ì§€ ì§€ì—° ë¡œë”©
   - í¬ë¦¬í‹°ì»¬ CSS ì¸ë¼ì¸í™”

   âœ… FID ìµœì í™”
   - í„°ì¹˜ ì§€ì—° ì œê±° (touch-action: manipulation)
   - GPU ê°€ì† í™œìš©
   - ë¶ˆí•„ìš”í•œ JavaScript ì œê±°
   - ì…ë ¥ ì‘ë‹µì„± ê°œì„ 

   âœ… CLS ìµœì í™”
   - ë ˆì´ì•„ì›ƒ ì˜ˆì•½ (min-height ì„¤ì •)
   - ì´ë¯¸ì§€ ë¹„ìœ¨ ê³ ì •
   - ìŠ¤ì¼ˆë ˆí†¤ ë¡œë” í¬ê¸° ê³ ì •
   - ë™ì  ì½˜í…ì¸  ì‚½ì… ìµœì í™”

   âœ… ì¶”ê°€ ì„±ëŠ¥ ê°œì„ 
   - ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ìµœì í™”
   - ë Œë”ë§ ì„±ëŠ¥ ê°œì„ 
   - ë„¤íŠ¸ì›Œí¬ ë¦¬ì†ŒìŠ¤ ìµœì í™”
   - ë¸Œë¼ìš°ì €ë³„ ìµœì í™” ì ìš©
   ============================================================================= */