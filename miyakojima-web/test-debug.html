<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¯¸ì•¼ì½”ì§€ë§ˆ ì•± ë””ë²„ê·¸ í…ŒìŠ¤íŠ¸</title>
    <style>
        body { font-family: 'Malgun Gothic', sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .loading { background-color: #fff3cd; border-color: #ffeeba; }
        #results { white-space: pre-wrap; font-family: monospace; }
    </style>
</head>
<body>
    <h1>ğŸï¸ ë¯¸ì•¼ì½”ì§€ë§ˆ ì•± ë””ë²„ê·¸ í…ŒìŠ¤íŠ¸</h1>
    
    <div class="test-section">
        <h2>ğŸ“‹ í…ŒìŠ¤íŠ¸ ê²°ê³¼</h2>
        <div id="results">í…ŒìŠ¤íŠ¸ ì‹œì‘ ì¤‘...</div>
    </div>

    <div class="test-section">
        <h2>ğŸ”§ ìˆ˜ë™ í…ŒìŠ¤íŠ¸ ë²„íŠ¼</h2>
        <button onclick="testModules()">ëª¨ë“ˆ í…ŒìŠ¤íŠ¸</button>
        <button onclick="testApp()">ì•± ì´ˆê¸°í™” í…ŒìŠ¤íŠ¸</button>
        <button onclick="clearLogs()">ë¡œê·¸ í´ë¦¬ì–´</button>
    </div>

    <!-- JavaScript íŒŒì¼ë“¤ ë¡œë“œ -->
    <script src="./js/config.js"></script>
    <script src="./js/utils.js"></script>
    <script src="./js/storage.js"></script>
    <script src="./js/api.js"></script>
    <script src="./js/budget.js"></script>
    <script src="./js/location.js"></script>
    <script src="./js/itinerary.js"></script>
    <script src="./js/poi.js"></script>

    <script>
        let testResults = [];
        
        function log(message, status = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${status.toUpperCase()}: ${message}\n`;
            testResults.push(logEntry);
            updateResults();
            
            if (status === 'error') {
                console.error(message);
            } else {
                console.log(message);
            }
        }
        
        function updateResults() {
            document.getElementById('results').textContent = testResults.join('');
        }
        
        function clearLogs() {
            testResults = [];
            updateResults();
        }
        
        function testModules() {
            log('=== ëª¨ë“ˆ í…ŒìŠ¤íŠ¸ ì‹œì‘ ===');
            
            // CONFIG í…ŒìŠ¤íŠ¸
            try {
                if (typeof CONFIG !== 'undefined') {
                    log(`âœ… CONFIG ë¡œë“œ ì„±ê³µ - ë²„ì „: ${CONFIG.APP_VERSION}`);
                } else {
                    log('âŒ CONFIG ë¡œë“œ ì‹¤íŒ¨', 'error');
                }
            } catch (e) {
                log(`âŒ CONFIG ì˜¤ë¥˜: ${e.message}`, 'error');
            }
            
            // Logger í…ŒìŠ¤íŠ¸
            try {
                if (typeof Logger !== 'undefined') {
                    Logger.info('Logger í…ŒìŠ¤íŠ¸ ì„±ê³µ');
                    log('âœ… Logger ë¡œë“œ ì„±ê³µ');
                } else {
                    log('âŒ Logger ë¡œë“œ ì‹¤íŒ¨', 'error');
                }
            } catch (e) {
                log(`âŒ Logger ì˜¤ë¥˜: ${e.message}`, 'error');
            }
            
            // Storage í…ŒìŠ¤íŠ¸
            try {
                if (typeof storage !== 'undefined') {
                    storage.set('test', 'test_value');
                    const testValue = storage.get('test');
                    if (testValue === 'test_value') {
                        log('âœ… Storage ë¡œë“œ ë° í…ŒìŠ¤íŠ¸ ì„±ê³µ');
                    } else {
                        log('âŒ Storage ê¸°ëŠ¥ ì˜¤ë¥˜', 'error');
                    }
                } else {
                    log('âŒ Storage ë¡œë“œ ì‹¤íŒ¨', 'error');
                }
            } catch (e) {
                log(`âŒ Storage ì˜¤ë¥˜: ${e.message}`, 'error');
            }
            
            // RateLimiter í…ŒìŠ¤íŠ¸
            try {
                if (typeof RateLimiter !== 'undefined') {
                    const limiter = new RateLimiter('test', { maxRequests: 5, windowMs: 60000 });
                    if (limiter.canMakeRequest()) {
                        log('âœ… RateLimiter ë¡œë“œ ë° í…ŒìŠ¤íŠ¸ ì„±ê³µ');
                    } else {
                        log('âŒ RateLimiter ê¸°ëŠ¥ ì˜¤ë¥˜', 'error');
                    }
                } else {
                    log('âŒ RateLimiter ë¡œë“œ ì‹¤íŒ¨', 'error');
                }
            } catch (e) {
                log(`âŒ RateLimiter ì˜¤ë¥˜: ${e.message}`, 'error');
            }
            
            // í´ë˜ìŠ¤ í…ŒìŠ¤íŠ¸
            const classes = [
                'BudgetTracker', 'LocationTracker', 'POIManager', 'ItineraryManager'
            ];
            
            classes.forEach(className => {
                try {
                    if (typeof window[className] !== 'undefined') {
                        log(`âœ… ${className} í´ë˜ìŠ¤ ë¡œë“œ ì„±ê³µ`);
                    } else {
                        log(`âš ï¸ ${className} í´ë˜ìŠ¤ ë¡œë“œ ì‹¤íŒ¨ (Mock ì‚¬ìš© ì˜ˆì •)`, 'warn');
                    }
                } catch (e) {
                    log(`âŒ ${className} ì˜¤ë¥˜: ${e.message}`, 'error');
                }
            });
            
            log('=== ëª¨ë“ˆ í…ŒìŠ¤íŠ¸ ì™„ë£Œ ===');
        }
        
        function testApp() {
            log('=== ì•± ì´ˆê¸°í™” í…ŒìŠ¤íŠ¸ ì‹œì‘ ===');
            
            try {
                // MiyakojimaApp í´ë˜ìŠ¤ê°€ ë¡œë“œë˜ì—ˆëŠ”ì§€ í™•ì¸
                if (typeof MiyakojimaApp !== 'undefined') {
                    log('âœ… MiyakojimaApp í´ë˜ìŠ¤ ë°œê²¬');
                    
                    // í…ŒìŠ¤íŠ¸ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
                    const testApp = new MiyakojimaApp();
                    log('âœ… MiyakojimaApp ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ì„±ê³µ');
                    
                } else {
                    log('âŒ MiyakojimaApp í´ë˜ìŠ¤ ë¡œë“œ ì‹¤íŒ¨', 'error');
                }
            } catch (e) {
                log(`âŒ ì•± ì´ˆê¸°í™” ì˜¤ë¥˜: ${e.message}`, 'error');
                log(`ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤: ${e.stack}`, 'error');
            }
            
            log('=== ì•± ì´ˆê¸°í™” í…ŒìŠ¤íŠ¸ ì™„ë£Œ ===');
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ í…ŒìŠ¤íŠ¸
        document.addEventListener('DOMContentLoaded', () => {
            log('ğŸš€ í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ, ìë™ í…ŒìŠ¤íŠ¸ ì‹œì‘');
            
            // 1ì´ˆ í›„ ëª¨ë“ˆ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
            setTimeout(() => {
                testModules();
            }, 1000);
        });
        
        // ì „ì—­ ì˜¤ë¥˜ ìºì¹˜
        window.addEventListener('error', (e) => {
            log(`ğŸ’¥ ì „ì—­ ì˜¤ë¥˜ ê°ì§€: ${e.error?.message || e.message}`, 'error');
            if (e.error?.stack) {
                log(`ìŠ¤íƒ: ${e.error.stack}`, 'error');
            }
        });
        
        window.addEventListener('unhandledrejection', (e) => {
            log(`ğŸ’¥ Promise ê±°ë¶€ ê°ì§€: ${e.reason}`, 'error');
        });
    </script>
</body>
</html>