<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>밸류에이션 실험실 - 100x FenoK</title>
  <meta name="robots" content="noindex, nofollow">
  <link rel="icon" type="image/x-icon" href="../../favicon.ico">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="styles/dashboard.css">
</head>
<body class="bg-gradient-to-br from-slate-100 to-slate-200 min-h-screen text-gray-800">

  <!-- Shared Modules -->
  <script src="../shared/config/manifest-loader.js"></script>
  <script src="../shared/core/cache-manager.js"></script>
  <script src="../shared/core/data-manager.js"></script>
  <script src="../shared/core/formatters.js"></script>
  <script src="../shared/validators/freshness-checker.js"></script>

  <!-- Valuation Lab Config -->
  <script src="shared/vlab-config.js"></script>
  <script src="shared/constants.js"></script>
  <script src="shared/calculations.js"></script>
  <script src="shared/indicators.js"></script>
  <script src="shared/security.js"></script>
  <script src="shared/validator.js"></script>

  <!-- App Modules (DEC-108: Data Lab Pattern) -->
  <script src="app/state-manager.js"></script>
  <script src="app/renderer.js"></script>

  <script>
    if (window.CacheManager) CacheManager.setPrefix('vlab_cache_');
  </script>

  <header class="py-6 border-b bg-white">
    <div class="container mx-auto px-4">
      <div class="flex flex-wrap items-center justify-between gap-4">
        <div class="flex items-center space-x-3">
          <div class="w-10 h-10 bg-amber-100 rounded-xl flex items-center justify-center">
            <i class="fas fa-flask text-amber-500"></i>
          </div>
          <div>
            <h1 class="text-xl font-bold">밸류에이션 실험실</h1>
            <p class="text-gray-500 text-sm">7개 데이터 소스 → MVP → 확장 → 배포</p>
          </div>
        </div>
        <div class="flex items-center gap-4">
          <span id="load-status" class="text-xs text-gray-400"></span>
          <a href="../" class="text-gray-500 hover:text-blue-600 text-sm">
            <i class="fas fa-arrow-left mr-1"></i> Admin
          </a>
        </div>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 py-8 space-y-10">
    <!-- Dynamic sections rendered by Renderer -->
    <section id="today-judgment"></section>
    <section id="pipeline"></section>
    <section id="workstreams" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"></section>
    <section id="checklist"></section>
  </main>

  <script>
    // Initialize on DOMContentLoaded
    document.addEventListener('DOMContentLoaded', async () => {
      console.log('[Valuation Lab] Initializing...');

      // Subscribe to state changes
      StateManager.subscribe('loading', (loading) => {
        const statusEl = document.getElementById('load-status');
        if (statusEl) {
          statusEl.textContent = loading ? '로딩 중...' : `로드 완료 (${StateManager.get('loadTime')}ms)`;
        }
      });

      // Render UI first (shows structure immediately)
      Renderer.render();

      // Then initialize data (async verification)
      await StateManager.initialize();

      // Re-render workstreams with status indicators
      Renderer.renderWorkstreams();

      console.log('[Valuation Lab] Ready');
    });
  </script>

</body>
</html>
