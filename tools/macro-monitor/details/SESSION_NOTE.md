# Liquidity Stress Monitor 개발 세션 노트

> **작성일**: 2025-11-29
> **최종 업데이트**: 2025-11-29
> **상태**: ✅ 안A+C + 차트 개선 + 반응형 하이브리드 완료

---

## 1. 완료된 작업

### 버그 수정 ✅
| 문제 | 원인 | 해결 |
|------|------|------|
| $3000T 표시 오류 | WRESBAL 단위가 Millions인데 /1000만 함 | `/1000000`으로 수정 |
| 1Y/MAX에서 LCLoR 값 다름 | GDP 분기별 데이터인데 Forward Fill 방식 사용 | 최신 GDP 고정값 사용 |

### 단위 정리
| Series | FRED 단위 | 변환 | 결과 |
|--------|----------|------|------|
| WRESBAL (Reserves) | Millions | ÷ 1,000,000 | ~$2.89T |
| GDP | Billions | ÷ 1,000 | ~$30.5T |
| LCLoR | GDP × 10% | (B × 0.1) ÷ 1000 | ~$3.05T |

---

## 2. 위험 판단 기준

### Tier 1: SOFR-IORB Spread
| 상태 | 스프레드 |
|------|----------|
| 정상 | < 10bp |
| 주의 | 10~20bp |
| 경계 | 20~30bp |
| 위험 | >30bp |

### Tier 2: Reserves / GDP
| 비율 | 상태 |
|------|------|
| >11% | 정상 |
| 10~11% | 주의 |
| 9~10% | 경계 ← **현재 ~9.5%** |
| <8% | 위험 |

---

## 3. 구현 완료 (안A-2 + 안C-1)

### 안C-1: 듀얼 세그먼트 게이지 ✅
- **위치**: 상단 (기존 숫자 Hero 대체)
- **스타일**: 세그먼트 프로그레스 바 + 마커
- **색상**: 파스텔 테마 (#86efac, #fde047, #fdba74, #fca5a5)
- **반응형**: PC 가로 / 모바일 세로

### 안A-2: 차트 기준선 ✅
```
─ ─ ─ [11% 주의] $3.35T  (노랑 점선)
─ ─ ─ [10% 경계] $3.05T  (빨강 점선)
───── [8% 위험]  $2.44T  (빨강 실선)
```
- **플러그인**: chartjs-plugin-annotation@2.2.1
- **라벨**: 퍼센트 + 상태명 + 금액

### 표현 정리 ✅
- 체온계/연료량 표현 삭제
- 발작 → 위험 통일
- LCLoR → 경계 통일
- (Left: 경보), (Right: 보유량) 삭제

---

## 4. 현재 파일 상태

```
details/
├── sofr-iorb.html      ← 기존 배포 버전
├── sofr-iorb2.html     ← 중간 버전
├── sofr-iorb3.html     ← sofr-iorb4 내용으로 덮어씌움
├── sofr-iorb4.html     ← 최신 완성본 ⭐
└── SESSION_NOTE.md     ← 이 파일
```

---

## 5. 차트 개선 (2025-11-29 추가)

### 적용된 개선 5가지 ✅
| 개선 | 내용 |
|------|------|
| 1. Gradient Fill | Reserves 영역 위→아래 그라데이션 (투명도 0.3→0.02) |
| 2. Glow Effect | Spread 라인에 shadow blur 8px 적용 |
| 3. Enhanced Tooltip | 날짜 📅 이모지, 상태 표시 (🟢🟡🟠🔴), RB/GDP% 추가 |
| 4. Threshold Backgrounds | 11%/10%/9%/8% 구간별 미묘한 배경색 (8% 투명도) |
| 5. Point Hover | 마우스 hover 시 포인트 표시 (radius 5-6px) |

### 기간 옵션 확장 ✅
| 변경 | 내용 |
|------|------|
| 기본값 | 3M → **1Y** |
| 옵션 | 1M/3M/6M/1Y/**3Y**/**MAX** |
| MAX 제한 | IORB 2021-07-29 시작 → ~4년 데이터만 가능 |

### 모바일 개선 ✅
- 차트 높이: 280px, min-height 250px (찐빵 방지)

---

## 6. 반응형 하이브리드 레이아웃 (2025-11-29 추가)

### Breakpoint 전략 ✅
| 화면 폭 | 레이아웃 | 차트 모드 |
|---------|----------|-----------|
| **< 600px** (모바일) | 탭 전환 + 스와이프 기간 | 싱글 축 (Spread or Reserves) |
| **600-899px** (태블릿) | 탭 전환 + 버튼 기간 | 싱글 축 |
| **≥ 900px** (PC) | 듀얼 축 유지 | 기존 방식 |

### 모바일 전용 기능 ✅
| 기능 | 설명 |
|------|------|
| **메트릭 탭** | [Spread] [Reserves] 탭으로 전환 |
| **스와이프 기간** | 좌우 스와이프로 1M↔3M↔6M↔1Y↔3Y↔MAX |
| **점 인디케이터** | 6개 dot으로 현재 기간 표시 |
| **간소화 Legend** | 3개 항목만 표시 |

### 싱글 축 차트 특징 ✅
- **Spread 탭**: 10bp/20bp/30bp 임계선 + 전체 Y축 활용
- **Reserves 탭**: 8%/10%/11% 임계선 + 구간별 배경색

### 라벨 위치/투명도 개선 ✅
- **위치**: `position: 'end'` → `'start'` (좌측으로 이동)
- **투명도**: 반투명 배경 (0.8~0.9) → 최신 데이터(우측) 가리지 않음
- **크기**: 폰트 9~10px, 패딩 3~4px로 간소화

---

## 7. 다음 작업 TODO

### 우선순위 (사용자 지정)
1. [ ] 하단 설명 카드 내용 정리
2. [ ] 위젯 디자인 확정
3. [ ] 메인 페이지 위젯 노출 계획 (개수, 배치)
4. [ ] 상단 메뉴 → 디테일 메뉴 vs 메인 페이지 논의
5. [ ] 설계 사상/기준 틀 문서화 (다음 위젯 빠르게 진행용)
6. [ ] HTML 제목 변경 및 연관 페이지 수정

### 대기
- [ ] 위젯-디테일 API 흐름 분석
